<h1 class="page-title">Provider Center Services</h1>
<section class="center-shifts">
  <div class="search-filter-container">
    <div class="d-flex align-items-center gap-4">
      <div class="flex-grow-1">
        <input type="text" class="form-control" placeholder="Search by Provider Name..." [(ngModel)]="searchProvider" (ngModelChange)="applyFilters()" />
      </div>
      <div>
        <select class="form-select" [(ngModel)]="filterService" (change)="applyFilters()">
          <option value="">All Services</option>
          <option *ngFor="let s of uniqueServiceNames" [value]="s">{{ s }}</option>
        </select>
      </div>
      <div>
        <button class="ClearFilters" (click)="searchProvider=''; filterService=''; applyFilters()">Clear Filters</button>
      </div>
    </div>
  </div>
  <div class="doctors-table my-3">
    <table class="table">
      <thead>
        <tr>
          <th>No.</th>
          <th>Provider Name</th>
          <th>Service Name</th>
          <th>Duration</th>
          <th>Price</th>
          <th>Edit</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let pcs of paginatedProviderCenterServices; let i = index">
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ pcs.ProviderName }}</td>
          <td>{{ pcs.ServiceName }}</td>
          <td>{{ pcs.Duration }}</td>
          <td>{{ pcs.Price }}</td>
          <td>
            <button type="button" class="btn details-btn" (click)="editPCS(pcs)">Edit</button>
          </td>
        </tr>
        <tr *ngIf="!filteredProviderCenterServices.length && !loading && !errorMessage">
          <td colspan="6" class="text-center py-4 text-muted">No Provider Center Services Found</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="pagination-container ms-5 my-3" *ngIf="filteredProviderCenterServices.length > 0">
    <div class="showing-text">
      Showing {{ (currentPage - 1) * pageSize + 1 }} -
      {{ getPaginationEndIndex() }} of {{ filteredProviderCenterServices.length }}
    </div>
    <div class="pagination-buttons d-flex">
      <button class="pagination-btn" (click)="goToPreviousPage()" [disabled]="currentPage === 1">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left"
          viewBox="0 0 16 16">
          <path fill-rule="evenodd"
            d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z" />
        </svg>
      </button>
      <button class="pagination-btn" (click)="goToNextPage()" [disabled]="currentPage === totalPages">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right"
          viewBox="0 0 16 16">
          <path fill-rule="evenodd"
            d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z" />
        </svg>
      </button>
    </div>
  </div>
  <div *ngIf="loading" class="text-center mt-3">
    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...
  </div>
  <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>
</section>

<!-- Edit Price Modal -->
<div class="modal fade show" tabindex="-1" [ngStyle]="{display: showEditModal ? 'block' : 'none', background: 'rgba(0,0,0,0.3)'}" *ngIf="showEditModal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Edit Price</h5>
        <button type="button" class="btn-close" (click)="closeEditModal()"></button>
      </div>
      <div class="modal-body">
        <div *ngIf="selectedPCS">
          <div class="mb-3">
            <label class="form-label">Provider: <b>{{ selectedPCS.ProviderName }}</b></label><br>
            <label class="form-label">Service: <b>{{ selectedPCS.ServiceName }}</b></label>
          </div>
          <div class="mb-3">
            <label for="editPrice" class="form-label">Price</label>
            <input type="number" id="editPrice" class="form-control" [(ngModel)]="editPrice" min="0" />
          </div>
          <div *ngIf="editError" class="alert alert-danger">{{ editError }}</div>
          <div *ngIf="editSuccess" class="alert alert-success">{{ editSuccess }}</div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="closeEditModal()" [disabled]="editLoading">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="saveEdit()" [disabled]="editLoading || editPrice == null || editPrice < 0">
          <span *ngIf="editLoading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          Save
        </button>
      </div>
    </div>
  </div>
</div> 