<!-- Dialog Version -->
<p-dialog 
  *ngIf="isDialog"
  [(visible)]="visible" 
  (onHide)="closeDialog()"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  header="Forgot Password"
  [style]="{width: '400px'}"
  [styleClass]="'forgot-password-dialog'"
>
  <div class="forgot-password-content">
    <p-toast></p-toast>
    
    <div *ngIf="!isEmailSent">
      <p class="text-muted mb-4">
        Enter your email address and we'll send you a link to reset your password.
      </p>

      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()">
        <div class="mb-3">
          <label for="email" class="form-label">Email Address</label>
          <input 
            pInputText 
            id="email"
            type="email"
            formControlName="email"
            placeholder="Enter your email address"
            [class.is-invalid]="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched"
            class="w-100"
          />
          
          <div *ngIf="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched" 
               class="invalid-feedback d-block">
            <small>{{ getErrorMessage('email') }}</small>
          </div>
        </div>

        <div class="d-grid gap-2">
          <p-button 
            type="submit" 
            label="Send Reset Link" 
            icon="pi pi-envelope"
            [loading]="isLoading"
            [disabled]="forgotPasswordForm.invalid || isLoading"
            class="w-100"
          ></p-button>
          
          <p-button 
            type="button" 
            label="Cancel" 
            severity="secondary"
            (onClick)="closeDialog()"
            [disabled]="isLoading"
            class="w-100"
          ></p-button>
        </div>
      </form>
    </div>

    <div *ngIf="isEmailSent" class="text-center">
      <i class="pi pi-check-circle text-success" style="font-size: 3rem;"></i>
      <h4 class="mt-3 text-success">Email Sent!</h4>
      <p class="text-muted">
        We've sent password reset instructions to your email address. 
        Please check your inbox and follow the link to reset your password.
      </p>
    </div>
  </div>
</p-dialog>

<!-- Page Version -->
<div *ngIf="!isDialog" class="forgot-password-container">
  <p-toast></p-toast>
  
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6 col-lg-5">
        <div class="forgot-password-card">
          <div class="text-center mb-4">
            <h2 class="forgot-title">Forgot Password?</h2>
            <p class="text-muted">Enter your email to reset your password</p>
          </div>

          <div *ngIf="!isEmailSent">
            <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()">
              <div class="mb-4">
                <label for="emailPage" class="form-label">Email Address</label>
                <input 
                  pInputText 
                  id="emailPage"
                  type="email"
                  formControlName="email"
                  placeholder="Enter your email address"
                  [class.is-invalid]="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched"
                  class="w-100"
                />
                
                <div *ngIf="forgotPasswordForm.get('email')?.invalid && forgotPasswordForm.get('email')?.touched" 
                     class="invalid-feedback d-block">
                  <small>{{ getErrorMessage('email') }}</small>
                </div>
              </div>

              <div class="d-grid mb-3">
                <p-button 
                  type="submit" 
                  label="Send Reset Link" 
                  icon="pi pi-envelope"
                  [loading]="isLoading"
                  [disabled]="forgotPasswordForm.invalid || isLoading"
                  class="w-100"
                ></p-button>
              </div>

              <div class="text-center">
                <a [routerLink]="['/login']" class="back-to-login">
                  <i class="pi pi-arrow-left me-1"></i>
                  Back to Login
                </a>
              </div>
            </form>
          </div>

          <div *ngIf="isEmailSent" class="text-center">
            <i class="pi pi-check-circle text-success" style="font-size: 4rem;"></i>
            <h3 class="mt-3 text-success">Email Sent Successfully!</h3>
            <p class="text-muted mb-4">
              We've sent password reset instructions to your email address. 
              Please check your inbox and follow the link to reset your password.
            </p>
            <p-button 
              label="Back to Login" 
              icon="pi pi-sign-in"
              [routerLink]="['/login']"
              class="w-100"
            ></p-button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div> 