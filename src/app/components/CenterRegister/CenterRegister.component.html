<div class="center-register-2col-container d-flex flex-row align-items-stretch min-vh-100">
  <!-- Illustration Box (1/3 width) -->
  <div class="register-illustration-box d-none d-md-flex flex-column justify-content-center align-items-center" style="flex:1;">
    <!-- Replace the src below with your own SVG or illustration -->
    <svg _ngcontent-ng-c773399610="" xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" width="300" height="300" viewBox="0 0 567.01 492.18"><defs _ngcontent-ng-c773399610=""><style _ngcontent-ng-c773399610=""> .cls-1 { fill: #e6ae38; } .cls-2 { fill: #ecf0f1; } </style></defs><path _ngcontent-ng-c773399610="" d="M1.01,3.46c0-.25-1.18-.8-.58-1.51L3.47.92c56.36,2.34,115-2.95,171.09,0,55.15,2.91,103.39,29.04,135.27,73.73,78.44,109.94,7.42,255.59-122.33,272.3l-186.98.02c-1.4-.17.5-1.28.5-1.5C1.01,231.47,1.41,117.46,1.01,3.46ZM77.01,73.96v154c31.16-4.1,54.56-28.74,74.96-50.5l-24.47-26.5c-.83-1.31-.83-2.69.52-3.49,30.07-9.36,60.89-16.4,91.98-21.5l-23.01,99.98c-3.62,2.53-15.37-15.67-17.9-18.35-.79-.84-.68-.92-2.06-.63-21.6,33.88-59.92,61.31-99.01,71l3.48.99c1.87.53,5.35-.33,7.34-.32,3.39.03,6.77.05,10.16.09,6.77.06,13.54.14,20.31.22,10.36.13,20.72.29,31.08.48,4.89.09,9.62.01,14.48-.28s9.66-1.45,14.37-1.45c121.55-17.91,118.84-191.41-1.74-203.72h-100.49Z" class="cls-2"></path><path _ngcontent-ng-c773399610="" d="M449.66,300.61c-45.41,44.79-113.64-24.86-66.69-69.19,44.83-42.32,110.83,25.65,66.69,69.19Z" class="cls-1"></path><path _ngcontent-ng-c773399610="" d="M161.79,380.24c70.03-7.99,93.12,80.98,32.9,106.9-52.4,22.55-105.19-35.14-72.08-83.08,8.45-12.24,24.32-22.12,39.19-23.81ZM171.68,400.35c-34.01-.62-47.6,46.16-19.2,64.64,19.65,12.78,43.97,2.51,50.82-19.22s-9.31-45.02-31.63-45.42Z" class="cls-2"></path><path _ngcontent-ng-c773399610="" d="M311.02,452.44v-1.47c26.1-8.77,27.65-45.55,6.9-61.42-5.96-4.56-16.03-7.86-23.41-8.59-15.31-1.52-32.94,1.13-48.5,0v108.5c0,.11,1.39,1.5,1.5,1.5h21c.11,0,1.5-1.39,1.5-1.5v-35.5c3.84.46,8.84-.67,12.48.02,7.43,1.42,18.65,31.2,25.02,36.98h25.5l-21.99-38.52ZM303.74,429.14c-1.01,1.1-2.24,1.96-3.48,2.78-1.16.77-2.38,1.78-3.79,2.01-1.17.19-2.39-.03-3.57,0s-2.46,0-3.69,0h-19.19v-31.98h22.5c8.17,0,15.58,8.44,15.58,16.5,0,3.93-1.7,7.81-4.35,10.68Z" class="cls-2"></path><path _ngcontent-ng-c773399610="" d="M2.01,380.96c.09-4.65,22.67-1.68,25.23-1.43,5.63.56,11.26,1.28,16.84,2.24,15.54,2.66,31.88,7.26,42.1,19.92,8.51,10.53,13.1,24.36,12.4,37.89-.14,2.69-.49,5.37-1.06,8.01-.18.82-.38,1.63-.6,2.44-1.04,3.8-2.52,7.49-4.37,10.97-18.57,34.81-56.71,29.93-90.54,29.96,0,0,0-109.98,0-110ZM25.01,468.96s20.5,0,20.5,0c23.58,0,37.74-32.6,25.62-51.4-6.71-10.41-20.34-14.95-32.22-14.8-1.05.01-13.89-.14-13.89.21v66Z" class="cls-2"></path><path _ngcontent-ng-c773399610="" d="M455.01,490.96h-24.5c-3.82-4.45-4.64-15.35-7.59-19.41-1.13-1.56-1.61-1.44-3.36-1.64-12.53-1.44-28.03,1.05-40.89.22-3.27,1.11-7.16,20.84-10.16,20.84h-23.5c11.84-36.4,26.46-71.95,39.56-107.94.63-1.32,1.59-1.77,2.96-2.04,2.63-.51,23.83-.32,25.48.47,1.21.58,1.97,2.31,2.48,3.52,13.13,35.32,27.34,70.43,39.51,105.99ZM415.01,448.96c-4.31-11.02-8.25-25.46-13.8-35.7-.36-.66-1.53-2.79-2.19-2.3l-15.01,38h31Z" class="cls-2"></path><path _ngcontent-ng-c773399610="" d="M495.01,380.96v48c5.79-5.27,11.29-11.17,16.51-16.99,3.57-3.97,24.93-31.01,26.99-31.01h26.5l-43.04,51.5,45.04,58.5h-27.5l-37.49-46.53c-.76-.57-7.01,5.56-7.01,6.03v40.5h-24v-110h24Z" class="cls-2"></path></svg>
    <h2 class="illustration-title mt-5">Welcome to Dorak!</h2>
    <p class="illustration-desc">Register your center and join our network for better queue management.</p>
  </div>
  <!-- Form Box (2/3 width) -->
  <div class="register-form-box d-flex flex-column justify-content-center align-items-center"
       [ngClass]="{'step-3-active': activeStepIndex === 2}"
       style="flex:2;">
    <div class="center-register-form-card shadow-lg rounded-4 mx-auto w-100" style="max-width: 600px; min-width: 320px; width: 65%;">
      <div class="register-header mb-4">
        <h1 class="welcome-title">Register Center</h1>
        <p class="welcome-subtitle">Fill in the details to register your center</p>
      </div>
      <div class="stepper-wrapper mb-4">
        <p-steps [model]="steps" [readonly]="false" [activeIndex]="activeStepIndex" class="custom-stepper"></p-steps>
      </div>
      <div class="step-content mt-4">
        <!-- Step 1: User Details -->
        <div *ngIf="activeStepIndex === 0" class="step-panel">
          <h2 class="step-title mb-2">User Details</h2>
          <p class="step-desc mb-4">Create your account credentials</p>
          <form *ngIf="activeStepIndex === 0" #userForm="ngForm" class="step-panel">
            <div class="field mb-3">
              <label for="username" class="form-label">Username</label>
              <input type="text" pInputText id="username" name="username" [(ngModel)]="user.username" class="form-control" required minlength="8" #usernameInput="ngModel" />
              <div *ngIf="usernameInput.invalid && usernameInput.touched" class="text-danger mt-1">
                <small *ngIf="usernameInput.errors?.['required']">Username is required</small>
                <small *ngIf="usernameInput.errors?.['minlength']">Username must be at least 8 characters</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="email" class="form-label">Email</label>
              <input type="email" pInputText id="email" name="email" [(ngModel)]="user.email" class="form-control" required minlength="6" #emailInput="ngModel" />
              <div *ngIf="emailInput.invalid && emailInput.touched" class="text-danger mt-1">
                <small *ngIf="emailInput.errors?.['required']">Email is required</small>
                <small *ngIf="emailInput.errors?.['email']">Please enter a valid email address</small>
                <small *ngIf="emailInput.errors?.['minlength']">Email must be at least 6 characters</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="phoneNumber" class="form-label">Phone Number</label>
              <input type="tel" pInputText id="phoneNumber" name="phoneNumber" [(ngModel)]="user.phoneNumber" class="form-control" required minlength="8" #phoneInput="ngModel" />
              <div *ngIf="phoneInput.invalid && phoneInput.touched" class="text-danger mt-1">
                <small *ngIf="phoneInput.errors?.['required']">Phone number is required</small>
                <small *ngIf="phoneInput.errors?.['minlength']">Phone number must be at least 8 characters</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="password" class="form-label">Password</label>
              <div class="password-input-container">
                <input [type]="showPassword ? 'text' : 'password'" pInputText id="password" name="password" [(ngModel)]="user.password" class="form-control" required minlength="8" #passwordInput="ngModel" />
                <button type="button" class="password-toggle-btn" (click)="togglePasswordVisibility()">
                  <i [class]="showPassword ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
                </button>
              </div>
              <div *ngIf="passwordInput.invalid && passwordInput.touched" class="text-danger mt-1">
                <small *ngIf="passwordInput.errors?.['required']">Password is required</small>
                <small *ngIf="passwordInput.errors?.['minlength']">Password must be at least 8 characters</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="confirmPassword" class="form-label">Confirm Password</label>
              <div class="password-input-container">
                <input [type]="showPassword ? 'text' : 'password'" pInputText id="confirmPassword" name="confirmPassword" [(ngModel)]="user.confirmPassword" class="form-control" required minlength="8" #confirmPasswordInput="ngModel" />
                <button type="button" class="password-toggle-btn" (click)="togglePasswordVisibility()">
                  <i [class]="showPassword ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
                </button>
              </div>
              <div *ngIf="confirmPasswordInput.invalid && confirmPasswordInput.touched" class="text-danger mt-1">
                <small *ngIf="confirmPasswordInput.errors?.['required']">Please confirm your password</small>
                <small *ngIf="confirmPasswordInput.errors?.['minlength']">Confirm password must be at least 8 characters</small>
              </div>
              <div *ngIf="user.password !== user.confirmPassword && user.confirmPassword" class="text-danger mt-1">
                <small>Passwords do not match</small>
              </div>
            </div>
            <input type="hidden" name="role" [(ngModel)]="user.role" />
          </form>
        </div>

        <!-- Step 2: Owner Details -->
        <div *ngIf="activeStepIndex === 1" class="step-panel">
          
          <h2 class="step-title mb-2">Owner Details</h2>
          <p class="step-desc mb-4">Tell us about the center owner</p>
          <form *ngIf="activeStepIndex === 1" #ownerForm="ngForm" class="step-panel">
            <div class="field mb-3">
              <label for="firstName" class="form-label">First Name</label>
              <input type="text" pInputText id="firstName" name="firstName" [(ngModel)]="owner.firstName" class="form-control" required #firstNameInput="ngModel" />
              <div *ngIf="firstNameInput.invalid && firstNameInput.touched" class="text-danger mt-1">
                <small>First name is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="lastName" class="form-label">Last Name</label>
              <input type="text" pInputText id="lastName" name="lastName" [(ngModel)]="owner.lastName" class="form-control" required #lastNameInput="ngModel" />
              <div *ngIf="lastNameInput.invalid && lastNameInput.touched" class="text-danger mt-1">
                <small>Last name is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="gender" class="form-label">Gender</label>
              <p-dropdown id="gender" name="gender" [options]="genderOptions" [(ngModel)]="owner.gender" placeholder="Select gender" class="w-100" [required]="true" #genderInput="ngModel"></p-dropdown>
              <div *ngIf="genderInput.invalid && genderInput.touched" class="text-danger mt-1">
                <small>Gender is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="image" class="form-label">Profile Image</label>
              <input type="file" id="image" name="image" (change)="onFileSelected($event)" class="form-control" accept="image/*" />
            </div>
          </form>
        </div>

        <!-- Step 3: Center Details -->
        <div *ngIf="activeStepIndex === 2" class="step-panel">
          <h2 class="step-title mb-2 ">Center Details</h2>
          <p class="step-desc mb-4">Enter your center's information</p>
          <form *ngIf=" activeStepIndex === 2" #centerForm="ngForm" class="step-panel">
            <div class="field mb-3">
              <label for="centerName" class="form-label">Center Name</label>
              <input type="text" pInputText id="centerName" name="centerName" [(ngModel)]="center.centerName" class="form-control" required #centerNameInput="ngModel" />
              <div *ngIf="centerNameInput.invalid && centerNameInput.touched" class="text-danger mt-1">
                <small>Center name is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="contactNumber" class="form-label">Contact Number</label>
              <input type="tel" pInputText id="contactNumber" name="contactNumber" [(ngModel)]="center.contactNumber" class="form-control" required #contactNumberInput="ngModel" />
              <div *ngIf="contactNumberInput.invalid && contactNumberInput.touched" class="text-danger mt-1">
                <small>Contact number is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="centerStreet" class="form-label">Street</label>
              <input type="text" pInputText id="centerStreet" name="centerStreet" [(ngModel)]="center.centerStreet" class="form-control" required #centerStreetInput="ngModel" />
              <div *ngIf="centerStreetInput.invalid && centerStreetInput.touched" class="text-danger mt-1">
                <small>Street is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="centerCity" class="form-label">City</label>
              <input type="text" pInputText id="centerCity" name="centerCity" [(ngModel)]="center.centerCity" class="form-control" required #centerCityInput="ngModel" />
              <div *ngIf="centerCityInput.invalid && centerCityInput.touched" class="text-danger mt-1">
                <small>City is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="centerCountry" class="form-label">Country</label>
              <input type="text" pInputText id="centerCountry" name="centerCountry" [(ngModel)]="center.centerCountry" class="form-control" required #centerCountryInput="ngModel" />
              <div *ngIf="centerCountryInput.invalid && centerCountryInput.touched" class="text-danger mt-1">
                <small>Country is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="centerEmail" class="form-label">Center Email</label>
              <input type="email" pInputText id="centerEmail" name="centerEmail" [(ngModel)]="center.centerEmail" class="form-control" required #centerEmailInput="ngModel" />
              <div *ngIf="centerEmailInput.invalid && centerEmailInput.touched" class="text-danger mt-1">
                <small>Email is required</small>
                <small *ngIf="centerEmailInput.errors?.['email']">Please enter a valid email address</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="websiteUrl" class="form-label">Website URL (optional)</label>
              <input type="text" pInputText id="websiteUrl" name="websiteUrl" [(ngModel)]="center.websiteUrl" class="form-control" />
            </div>
            <div class="field mb-3">
              <label for="centerGovernorate" class="form-label">Governorate</label>
              <input type="text" pInputText id="centerGovernorate" name="centerGovernorate" [(ngModel)]="center.centerGovernorate" class="form-control" required #centerGovernorateInput="ngModel" />
              <div *ngIf="centerGovernorateInput.invalid && centerGovernorateInput.touched" class="text-danger mt-1">
                <small>Governorate is required</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="latitude" class="form-label">Latitude (optional)</label>
              <input type="text" pInputText id="latitude" name="latitude" [(ngModel)]="center.latitude" class="form-control" inputmode="decimal" pattern="^-?\\d+(\\.\\d+)?$" />
              <div *ngIf="center.latitude && !isValidDecimal(center.latitude)" class="text-danger mt-1">
                <small>Latitude must be a valid decimal number</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="longitude" class="form-label">Longitude (optional)</label>
              <input type="text" pInputText id="longitude" name="longitude" [(ngModel)]="center.longitude" class="form-control" inputmode="decimal" pattern="^-?\\d+(\\.\\d+)?$" />
              <div *ngIf="center.longitude && !isValidDecimal(center.longitude)" class="text-danger mt-1">
                <small>Longitude must be a valid decimal number</small>
              </div>
            </div>
            <div class="field mb-3">
              <label for="mapUrl" class="form-label">Map URL (optional)</label>
              <input type="text" pInputText id="mapUrl" name="mapUrl" [(ngModel)]="center.mapUrl" class="form-control" />
            </div>
          </form>
        </div>
      </div>
      <div class="step-navigation mt-4 d-flex justify-content-between align-items-center sticky-bottom bg-white py-3 px-2 rounded-3 shadow-sm">
        <button pButton type="button" label="Previous" icon="pi pi-chevron-left" class="p-button-secondary me-2" *ngIf="activeStepIndex > 0" (click)="previousStep()"></button>
        <div class="ms-auto d-flex gap-2">
          <button pButton type="button" label="Next" icon="pi pi-chevron-right" iconPos="right" class="p-button-primary" *ngIf="activeStepIndex < 2" (click)="nextStep()" [disabled]="!isCurrentStepValid()"></button>
          <button pButton type="button" label="Register Center" icon="pi pi-check" class="p-button-success px-4" *ngIf="activeStepIndex === 2" (click)="onRegister()" [disabled]="!isCurrentStepValid() || isLoading">
            <span *ngIf="isLoading" class="pi pi-spin pi-spinner ms-2"></span>
          </button>
        </div>
      </div>
      <div class="signin-section text-center mt-4">
        <span class="signin-text">Already have an account? </span>
        <a [routerLink]="['/login']" routerLinkActive="router-link-active" class="signin-link">
          Back to login
        </a>
      </div>
    </div>
  </div>
</div>
